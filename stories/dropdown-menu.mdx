import { Meta, Canvas, Controls, Story } from "@storybook/blocks";
import * as DropdownMenuStories from "./dropdown-menu.stories";

<Meta of={DropdownMenuStories} />

# Dropdown Menu

A versatile dropdown menu component built on Radix UI with support for submenus, checkboxes, radio groups, keyboard shortcuts, and rich content.

<Canvas of={DropdownMenuStories.Default} />

## Usage

```tsx
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu";
import { Button } from "@/components/ui/button";

function Example() {
  return (
    <DropdownMenu>
      <DropdownMenuTrigger asChild>
        <Button variant="outline">Open Menu</Button>
      </DropdownMenuTrigger>
      <DropdownMenuContent>
        <DropdownMenuItem>Profile</DropdownMenuItem>
        <DropdownMenuItem>Settings</DropdownMenuItem>
        <DropdownMenuItem>Logout</DropdownMenuItem>
      </DropdownMenuContent>
    </DropdownMenu>
  );
}
```

## API

<Controls />

### Core Props

**DropdownMenu**

- **open** - Controlled open state
- **defaultOpen** - Default open state (uncontrolled)
- **onOpenChange** - Callback when open state changes
- **modal** - Whether the dropdown blocks interaction with the rest of the page (default: true)
- **dir** - Reading direction (ltr | rtl)

**DropdownMenuTrigger**

- **asChild** - Merge props with child element instead of rendering a button

**DropdownMenuContent**

- **align** - Alignment relative to trigger (start | center | end)
- **sideOffset** - Distance from trigger in pixels
- **className** - Custom CSS classes

## Components

The dropdown menu consists of several composable components:

- **DropdownMenu** - Root container component
- **DropdownMenuTrigger** - Button or element that opens the menu
- **DropdownMenuContent** - The dropdown panel that appears
- **DropdownMenuItem** - Individual menu items
- **DropdownMenuLabel** - Section labels
- **DropdownMenuSeparator** - Visual dividers between sections
- **DropdownMenuShortcut** - Keyboard shortcut indicators
- **DropdownMenuCheckboxItem** - Checkbox menu items
- **DropdownMenuRadioGroup** - Radio button group container
- **DropdownMenuRadioItem** - Radio button items
- **DropdownMenuSub** - Submenu container
- **DropdownMenuSubTrigger** - Submenu trigger
- **DropdownMenuSubContent** - Submenu content
- **DropdownMenuGroup** - Logical grouping for items

## Examples

### With Icons

Add icons to menu items for better visual clarity:

```tsx
import { User, Settings, LogOut } from "lucide-react";

<DropdownMenu>
  <DropdownMenuTrigger asChild>
    <Button variant="outline">Account</Button>
  </DropdownMenuTrigger>
  <DropdownMenuContent className="w-56">
    <DropdownMenuLabel>My Account</DropdownMenuLabel>
    <DropdownMenuSeparator />
    <DropdownMenuItem>
      <User className="mr-2 h-4 w-4" />
      <span>Profile</span>
    </DropdownMenuItem>
    <DropdownMenuItem>
      <Settings className="mr-2 h-4 w-4" />
      <span>Settings</span>
    </DropdownMenuItem>
    <DropdownMenuSeparator />
    <DropdownMenuItem>
      <LogOut className="mr-2 h-4 w-4" />
      <span>Log out</span>
    </DropdownMenuItem>
  </DropdownMenuContent>
</DropdownMenu>;
```

<Canvas of={DropdownMenuStories.WithIcons} />

### With Keyboard Shortcuts

Display keyboard shortcuts to help users learn and use shortcuts:

```tsx
<DropdownMenuItem>
  <User className="mr-2 h-4 w-4" />
  <span>Profile</span>
  <DropdownMenuShortcut>⇧⌘P</DropdownMenuShortcut>
</DropdownMenuItem>
```

<Canvas of={DropdownMenuStories.WithShortcuts} />

### With Checkboxes

Use checkbox items for toggleable options:

```tsx
import { useState } from "react";

function ViewMenu() {
  const [showStatusBar, setShowStatusBar] = useState(true);
  const [showPanel, setShowPanel] = useState(false);

  return (
    <DropdownMenu>
      <DropdownMenuTrigger asChild>
        <Button variant="outline">View</Button>
      </DropdownMenuTrigger>
      <DropdownMenuContent className="w-56">
        <DropdownMenuLabel>Appearance</DropdownMenuLabel>
        <DropdownMenuSeparator />
        <DropdownMenuCheckboxItem
          checked={showStatusBar}
          onCheckedChange={setShowStatusBar}
        >
          Status Bar
        </DropdownMenuCheckboxItem>
        <DropdownMenuCheckboxItem
          checked={showPanel}
          onCheckedChange={setShowPanel}
        >
          Panel
        </DropdownMenuCheckboxItem>
      </DropdownMenuContent>
    </DropdownMenu>
  );
}
```

<Canvas of={DropdownMenuStories.WithCheckboxes} />

### With Radio Groups

Use radio groups for mutually exclusive options:

```tsx
import { useState } from "react";

function PositionMenu() {
  const [position, setPosition] = useState("bottom");

  return (
    <DropdownMenu>
      <DropdownMenuTrigger asChild>
        <Button variant="outline">Panel Position</Button>
      </DropdownMenuTrigger>
      <DropdownMenuContent className="w-56">
        <DropdownMenuLabel>Panel Position</DropdownMenuLabel>
        <DropdownMenuSeparator />
        <DropdownMenuRadioGroup value={position} onValueChange={setPosition}>
          <DropdownMenuRadioItem value="top">Top</DropdownMenuRadioItem>
          <DropdownMenuRadioItem value="bottom">Bottom</DropdownMenuRadioItem>
          <DropdownMenuRadioItem value="right">Right</DropdownMenuRadioItem>
        </DropdownMenuRadioGroup>
      </DropdownMenuContent>
    </DropdownMenu>
  );
}
```

<Canvas of={DropdownMenuStories.WithRadioGroup} />

### With Submenus

Create nested menus for grouped actions:

```tsx
<DropdownMenu>
  <DropdownMenuTrigger asChild>
    <Button variant="outline">More Options</Button>
  </DropdownMenuTrigger>
  <DropdownMenuContent className="w-56">
    <DropdownMenuItem>
      <User className="mr-2 h-4 w-4" />
      <span>Profile</span>
    </DropdownMenuItem>
    <DropdownMenuSub>
      <DropdownMenuSubTrigger>
        <Users className="mr-2 h-4 w-4" />
        <span>Invite users</span>
      </DropdownMenuSubTrigger>
      <DropdownMenuSubContent>
        <DropdownMenuItem>
          <Mail className="mr-2 h-4 w-4" />
          <span>Email</span>
        </DropdownMenuItem>
        <DropdownMenuItem>
          <MessageSquare className="mr-2 h-4 w-4" />
          <span>Message</span>
        </DropdownMenuItem>
      </DropdownMenuSubContent>
    </DropdownMenuSub>
  </DropdownMenuContent>
</DropdownMenu>
```

<Canvas of={DropdownMenuStories.WithSubmenu} />

### Disabled Items

Disable items that are temporarily unavailable:

```tsx
<DropdownMenuItem disabled>
  <Plus className="mr-2 h-4 w-4" />
  <span>Add to favorites</span>
</DropdownMenuItem>
```

<Canvas of={DropdownMenuStories.WithDisabledItems} />

### Action Menu

Common pattern for row actions in tables:

```tsx
import { MoreHorizontal } from "lucide-react";

<DropdownMenu>
  <DropdownMenuTrigger asChild>
    <Button variant="ghost" size="sm">
      <MoreHorizontal className="h-4 w-4" />
    </Button>
  </DropdownMenuTrigger>
  <DropdownMenuContent align="end" className="w-48">
    <DropdownMenuItem>Edit</DropdownMenuItem>
    <DropdownMenuItem>Duplicate</DropdownMenuItem>
    <DropdownMenuItem>Archive</DropdownMenuItem>
    <DropdownMenuSeparator />
    <DropdownMenuItem className="text-destructive">Delete</DropdownMenuItem>
  </DropdownMenuContent>
</DropdownMenu>;
```

<Canvas of={DropdownMenuStories.ActionMenu} />

### Complex Menu

Full-featured menu with multiple sections and item types:

<Canvas of={DropdownMenuStories.ComplexExample} />

## Best Practices

### Do's

- Use clear, action-oriented labels for menu items
- Group related actions with separators and labels
- Add icons to improve scannability
- Display keyboard shortcuts for frequently used actions
- Use destructive styling for dangerous actions (delete, remove)
- Place most common actions at the top
- Use radio groups for mutually exclusive options
- Keep menu width consistent (usually w-48 or w-56)

### Don'ts

- Don't create overly deep nested menus (max 2-3 levels)
- Don't use dropdown menus for primary navigation
- Don't overuse icons - only for recognizable actions
- Don't make menus too wide (> 300px)
- Don't put too many items in a single menu (> 15)
- Don't use dropdowns when a simple button would suffice
- Don't forget to disable unavailable actions
- Don't use submenus for single items

## Accessibility

### Keyboard Navigation

The dropdown menu is fully keyboard accessible:

- **Tab** - Focus the trigger button
- **Enter** or **Space** - Open the menu
- **Arrow Down/Up** - Navigate between items
- **Arrow Right** - Open submenu
- **Arrow Left** - Close submenu and return to parent
- **Esc** - Close menu and return focus to trigger
- **Home** - Jump to first item
- **End** - Jump to last item
- **Type to search** - Jump to item starting with typed characters

<Canvas of={DropdownMenuStories.KeyboardNavigation} />

### Screen Readers

The component uses proper ARIA attributes:

- `role="menu"` on the content container
- `role="menuitem"` on clickable items
- `role="menuitemcheckbox"` on checkbox items
- `role="menuitemradio"` on radio items
- `aria-expanded` indicates submenu state
- `aria-checked` indicates selection state
- `aria-disabled` for disabled items

Always provide clear, descriptive labels:

```tsx
<DropdownMenuTrigger asChild>
  <Button variant="ghost" size="sm" aria-label="Open user menu">
    <MoreHorizontal className="h-4 w-4" />
  </Button>
</DropdownMenuTrigger>
```

### Focus Management

The dropdown menu manages focus properly:

- Focus automatically moves to first item when opened
- Focus returns to trigger when closed
- Focus trapped within menu while open
- Submenu focus managed independently
- Disabled items are skipped during navigation

### Visual Indicators

- Checkbox items show checked state with checkmark icon
- Radio items show selected state with dot indicator
- Submenu items show arrow indicator
- Disabled items have reduced opacity
- Destructive items use warning color
- Keyboard shortcuts displayed but not interactive

## Common Patterns

### User Account Menu

```tsx
<DropdownMenu>
  <DropdownMenuTrigger asChild>
    <Button variant="ghost" className="relative h-8 w-8 rounded-full">
      <Avatar>
        <AvatarImage src="/avatar.jpg" alt="User" />
        <AvatarFallback>JD</AvatarFallback>
      </Avatar>
    </Button>
  </DropdownMenuTrigger>
  <DropdownMenuContent align="end">
    <DropdownMenuLabel>My Account</DropdownMenuLabel>
    <DropdownMenuSeparator />
    <DropdownMenuItem>Profile</DropdownMenuItem>
    <DropdownMenuItem>Settings</DropdownMenuItem>
    <DropdownMenuSeparator />
    <DropdownMenuItem>Log out</DropdownMenuItem>
  </DropdownMenuContent>
</DropdownMenu>
```

### Table Row Actions

```tsx
<DropdownMenu>
  <DropdownMenuTrigger asChild>
    <Button variant="ghost" size="sm">
      <MoreHorizontal className="h-4 w-4" />
    </Button>
  </DropdownMenuTrigger>
  <DropdownMenuContent align="end">
    <DropdownMenuItem onClick={() => handleEdit(row)}>Edit</DropdownMenuItem>
    <DropdownMenuItem onClick={() => handleDuplicate(row)}>
      Duplicate
    </DropdownMenuItem>
    <DropdownMenuSeparator />
    <DropdownMenuItem
      className="text-destructive"
      onClick={() => handleDelete(row)}
    >
      Delete
    </DropdownMenuItem>
  </DropdownMenuContent>
</DropdownMenu>
```

### Context Menu Style

```tsx
<DropdownMenu>
  <DropdownMenuTrigger asChild>
    <div className="rounded-md border p-4">Right click for options</div>
  </DropdownMenuTrigger>
  <DropdownMenuContent>
    <DropdownMenuItem>Copy</DropdownMenuItem>
    <DropdownMenuItem>Cut</DropdownMenuItem>
    <DropdownMenuItem>Paste</DropdownMenuItem>
  </DropdownMenuContent>
</DropdownMenu>
```

## Related Components

- [Button](/docs/components-button--docs) - Often used as trigger
- [Select](/docs/components-select--docs) - For form select inputs
