import { Meta, Canvas, Controls, Story } from "@storybook/blocks";
import * as DialogStories from "./dialog.stories";

<Meta of={DialogStories} />

# Dialog

A modal dialog component built on Radix UI primitives with focus management, backdrop close, and keyboard support.

<Canvas of={DialogStories.Default} />

## Usage

```tsx
import {
  Dialog,
  DialogTrigger,
  DialogContent,
  DialogHeader,
  DialogTitle,
  DialogDescription,
} from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";

function Example() {
  return (
    <Dialog>
      <DialogTrigger asChild>
        <Button>Open Dialog</Button>
      </DialogTrigger>
      <DialogContent>
        <DialogHeader>
          <DialogTitle>Dialog Title</DialogTitle>
          <DialogDescription>This is a dialog description.</DialogDescription>
        </DialogHeader>
        {/* Your content here */}
      </DialogContent>
    </Dialog>
  );
}
```

## API

### Dialog Props

- **open** - Controlled open state (boolean)
- **defaultOpen** - Initial open state (boolean)
- **onOpenChange** - Callback when open state changes

### DialogContent Props

- **showClose** - Show or hide close button (default: `true`)
- **className** - Custom CSS classes
- **onOpenAutoFocus** - Focus management on open
- **onCloseAutoFocus** - Focus management on close

### Composition

The Dialog component is composed of several subcomponents:

- **Dialog** - Root container (from Radix UI)
- **DialogTrigger** - Button to open the dialog
- **DialogContent** - Modal content container
- **DialogHeader** - Header section container
- **DialogTitle** - Title element
- **DialogDescription** - Description text
- **DialogFooter** - Footer section container
- **DialogClose** - Close button trigger

## Features

### Basic Dialog

A simple dialog with title and description:

```tsx
<Dialog>
  <DialogTrigger asChild>
    <Button>Open</Button>
  </DialogTrigger>
  <DialogContent>
    <DialogHeader>
      <DialogTitle>Title</DialogTitle>
      <DialogDescription>Description text here</DialogDescription>
    </DialogHeader>
  </DialogContent>
</Dialog>
```

<Canvas of={DialogStories.Default} />

### With Actions

Add action buttons in the footer:

```tsx
<Dialog>
  <DialogTrigger asChild>
    <Button>Open</Button>
  </DialogTrigger>
  <DialogContent>
    <DialogHeader>
      <DialogTitle>Confirm Action</DialogTitle>
    </DialogHeader>
    <DialogFooter>
      <DialogClose asChild>
        <Button variant="outline">Cancel</Button>
      </DialogClose>
      <DialogClose asChild>
        <Button>Confirm</Button>
      </DialogClose>
    </DialogFooter>
  </DialogContent>
</Dialog>
```

<Canvas of={DialogStories.WithActions} />

### With Form

Embed forms inside dialogs for user input:

```tsx
<Dialog>
  <DialogTrigger asChild>
    <Button>Edit Profile</Button>
  </DialogTrigger>
  <DialogContent>
    <DialogHeader>
      <DialogTitle>Edit Profile</DialogTitle>
    </DialogHeader>
    <div className="space-y-4">
      <Input label="Name" />
      <Input label="Email" type="email" />
    </div>
    <DialogFooter>
      <DialogClose asChild>
        <Button variant="outline">Cancel</Button>
      </DialogClose>
      <DialogClose asChild>
        <Button>Save</Button>
      </DialogClose>
    </DialogFooter>
  </DialogContent>
</Dialog>
```

<Canvas of={DialogStories.WithForm} />

### Destructive Actions

For confirmation dialogs with destructive actions:

```tsx
<Dialog>
  <DialogTrigger asChild>
    <Button variant="destructive">Delete</Button>
  </DialogTrigger>
  <DialogContent>
    <DialogHeader>
      <DialogTitle>Delete Item</DialogTitle>
      <DialogDescription>
        This action cannot be undone. Are you sure?
      </DialogDescription>
    </DialogHeader>
    <DialogFooter>
      <DialogClose asChild>
        <Button variant="outline">Cancel</Button>
      </DialogClose>
      <DialogClose asChild>
        <Button variant="destructive">Delete</Button>
      </DialogClose>
    </DialogFooter>
  </DialogContent>
</Dialog>
```

<Canvas of={DialogStories.Destructive} />

### Controlled Dialog

Control dialog state from outside:

```tsx
const [open, setOpen] = useState(false);

<Dialog open={open} onOpenChange={setOpen}>
  <DialogTrigger asChild>
    <Button>Open</Button>
  </DialogTrigger>
  <DialogContent>
    <DialogHeader>
      <DialogTitle>Controlled Dialog</DialogTitle>
    </DialogHeader>
  </DialogContent>
</Dialog>;
```

<Canvas of={DialogStories.Controlled} />

### Multi-step Dialog

Create wizard-like dialogs with multiple steps:

```tsx
const [step, setStep] = useState(1);

<Dialog>
  <DialogTrigger asChild>
    <Button>Start Setup</Button>
  </DialogTrigger>
  <DialogContent>
    <DialogHeader>
      <DialogTitle>Setup - Step {step} of 3</DialogTitle>
    </DialogHeader>
    {step === 1 && <Step1Form />}
    {step === 2 && <Step2Form />}
    {step === 3 && <Step3Form />}
    <DialogFooter>
      {step > 1 && <Button onClick={() => setStep(step - 1)}>Back</Button>}
      {step < 3 && <Button onClick={() => setStep(step + 1)}>Next</Button>}
      {step === 3 && (
        <DialogClose asChild>
          <Button>Finish</Button>
        </DialogClose>
      )}
    </DialogFooter>
  </DialogContent>
</Dialog>;
```

<Canvas of={DialogStories.MultiStep} />

### Long Content

Dialogs automatically scroll when content overflows:

```tsx
<DialogContent className="max-h-[80vh] overflow-y-auto">
  <DialogHeader>
    <DialogTitle>Terms and Conditions</DialogTitle>
  </DialogHeader>
  <div className="space-y-4 text-sm">{/* Long content here */}</div>
</DialogContent>
```

<Canvas of={DialogStories.LongContent} />

### Without Close Button

Hide the close button for critical actions:

```tsx
<DialogContent showClose={false}>{/* Content */}</DialogContent>
```

<Canvas of={DialogStories.WithoutCloseButton} />

## Examples

### All Variants

<Canvas of={DialogStories.AllVariants} />

## Best Practices

### Do's

- Use for important confirmations and user input
- Keep content focused and concise
- Provide clear action buttons (primary, secondary, destructive)
- Use `DialogClose asChild` with Button for consistency
- Focus the most important action on load with `onOpenAutoFocus`
- Include descriptive titles and descriptions
- Handle keyboard events for better UX
- Test on mobile devices

### Don'ts

- Don't nest dialogs (use single dialog with steps instead)
- Don't make dialogs too wide (max 600px recommended)
- Don't include too much content (use scrolling or steps)
- Don't use for non-critical information (use Toast instead)
- Don't hide the close button for non-destructive actions
- Don't auto-close on form submission without feedback
- Don't make dialogs modal=false without good reason

## Accessibility

### Focus Management

Focus is automatically trapped and managed:

- Moves to dialog on open
- Returns to trigger on close
- Cycles through focusable elements
- Can be customized with `onOpenAutoFocus`

### Keyboard Navigation

- `Escape` - Close dialog
- `Tab` - Cycle through focusable elements
- `Shift+Tab` - Reverse cycle
- `Enter` - Activate buttons
- `Space` - Toggle buttons/checkboxes

### Screen Readers

Proper ARIA attributes are included:

```tsx
// Automatic ARIA labels for:
// - aria-modal="true"
// - aria-labelledby (points to title)
// - aria-describedby (points to description)
// - Role: dialog
```

Focus trap ensures screen readers don't escape the dialog.

### Visual Indicators

- Overlay shows modal context
- Close button is always visible (unless `showClose={false}`)
- Focus indicators are visible with 2px ring
- Buttons follow standard patterns

## States

### Default (Closed)

Dialog is closed by default until triggered.

### Open

Dialog appears with overlay and focus trap active.

### Loading

Show loading state while processing:

```tsx
const [loading, setLoading] = useState(false);

<DialogFooter>
  <Button loading={loading}>Save</Button>
</DialogFooter>;
```

### Disabled

Disable actions while processing:

```tsx
<DialogFooter>
  <Button disabled={loading}>Cancel</Button>
  <Button disabled={loading} loading={loading}>
    Save
  </Button>
</DialogFooter>
```

## Related Components

- [Button](/docs/components-button--docs) - Dialog triggers and actions
- [Input](/docs/components-input--docs) - Form fields in dialogs
- [Checkbox](/docs/components-checkbox--docs) - Checkboxes in dialogs
- [Toast](/docs/components-toast--docs) - For non-critical alerts
- [Tooltip](/docs/components-tooltip--docs) - For inline help
